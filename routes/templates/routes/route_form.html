{% extends 'layout.html' %}

{% block title %}{% if route.instance %}Edit Route{% else %}New Route{% endif %}{% endblock %}

{% block body %}
  
  <h1>{% if not route.instance.pk %}Create Route{% else %}Edit Route{% endif %}</h1>
  <br />
  
      <form method="post" id="route-form">
	{{ route.as_p }}
	{% csrf_token %}

	<div class="grid-container">

	  <label>User</label>
	  <autocomplete name="user" :items="users" label="username"></autocomplete>
	  <br /><br />
	  <v-autocomplete 
	    :input-attrs="{id: 'start'}"
	    :items="userLabels"
	    v-model="userName"
	    :get-label="getUsername"></v-autocomplete>

	  <destination v-for="dest in dests"
		       :key="dest.name"
		       :name="dest.name"
		       :user-labels="dest.userLabels"
		       :group-labels="dest.groupLabels"
		       :users="dest.users"
		       :groups="dest.groups"
		       :is-removeable="dest.isRemoveable"></destination>
	  

	  <div id="archiveDest" class="card route-dest-card">
	    <div class="card-divider">
	      Archive
	    </div>
	    <div class="card-section">
	     The Final Countdown... err Destination
	    </div>
	  </div>
	</div>

	<div class="row">
	  <div class="columns large-4">
	    <button class="button small" type="button" @click="addDest">Add Destination</button>
	  </div>
	  
	  <div class="columns large-4">
	    <input class="button" type="submit" value="Save" />
	    {% if route.instance.pk %}
	      <a href="{% url 'routes:detail' pk=route.instance.pk %}" class="button secondary">Cancel</a>
	      <a href="{% url 'routes:delete' pk=route.instance.pk %}" class="button tiny alert float-right">Delete</a>
	    {% endif %}
	  </div>
	</div>
      </form>

{% endblock %}

{% block vue %}
  {% include 'route_vue.html' %}
{% endblock %}
